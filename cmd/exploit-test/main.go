package main

import (
	"fmt"
	"net"
	"time"
)

func main() {
	target := "localhost:3000"
	fmt.Println("ðŸ•µï¸ Starting Security Audit / Exploit Test...")
	fmt.Printf("Targets: %s\n\n", target)

	// SCENARIO 1: LAZY SORT ATTACK
	// Sends a block proof that claims to be sorted but is actually random garbage
	fmt.Println("[ATTACK 1] Trying 'Lazy Sort' Attack...")
	conn, err := net.Dial("tcp", target)
	if err == nil {
		// Send fake proof
		fakeProof := "PROOF:deadbeef00000000000000000000000000000000000000000000000000000000"
		conn.Write([]byte(fakeProof + "\n"))
		conn.Close()
		fmt.Println("   -> Sent fake proof. Check node logs for rejection.")
	} else {
		fmt.Println("   -> Failed to connect.")
	}

	time.Sleep(2 * time.Second)

	// SCENARIO 2: REPLAY ATTACK
	// Sends the same valid transaction 100 times
	fmt.Println("\n[ATTACK 2] Trying 'Replay Attack' (Tx Flooding)...")
	conn, err = net.Dial("tcp", target)
	if err == nil {
		validTx := "{\"jsonrpc\":\"2.0\",\"method\":\"add_tx\",\"params\":[\"legit_tx_nonce_1\"]}\n"

		for i := 0; i < 100; i++ {
			conn.Write([]byte(validTx))
			time.Sleep(10 * time.Millisecond)
		}
		conn.Close()
		fmt.Println("   -> Flooded 100 identical transactions.")
	}

	fmt.Println("\nâœ… Audit Scenarios Executed.")
}
